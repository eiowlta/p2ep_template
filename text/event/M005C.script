function START()
{
    screenEffectInit();
    screenFade(160, 120, rgb(255,255,255), rgb(255,255,255), sub);
    sndMusicPlay(sound_3064, 127);
    levelFootstepSet(sfx_1a);
    envTriggerSet(EXITBOX, 131, 2, line, coll_2d);
    bitGet(var_0, bit_c63);
    bne(var_0, 0, label_8);
    b(label_f);
  label_8:
    bne(var_0, 1, label_f);
    ref_9 = spriteLoad(sprite_18);
    wait(ref_9);
    ref_b = spriteLoad(sprite_11f);
    wait(ref_b);
    bitSet(LBIT_0003);
    b(label_f);
  label_f:
    bitGet(var_0, bit_c67);
    bne(var_0, 0, label_12);
    b(label_19);
  label_12:
    bne(var_0, 1, label_19);
    ref_13 = spriteLoad(sprite_18);
    wait(ref_13);
    ref_15 = spriteLoad(sprite_11f);
    wait(ref_15);
    bitSet(LBIT_0003);
    b(label_19);
  label_19:
    bitGet(var_0, bit_c6b);
    bne(var_0, 0, label_1c);
    b(label_1f);
  label_1c:
    bne(var_0, 1, label_1f);
    bitSet(LBIT_0003);
    b(label_1f);
  label_1f:
    shopInventory(3, shopInventory_2a9);
    bne(var_3, 0, label_22);
    b(label_25);
  label_22:
    bne(var_3, 1, label_25);
    bitSet(LBIT_0003);
    b(label_25);
  label_25:
    li(var_0, 0);
    partyMemberCheck(var_0, ulala);
    add(var_5, var_5, var_0);
    bez(var_0, label_2d);
    ref_29 = spriteLoad(sprite_6);
    wait(ref_29);
    unitSpawn(ulala, sprite_6, 1033, 0, -1163, south, none);
    unitTriggerSet(ulala, B_URARATI, 255, 1);
  label_2d:
    partyMemberCheck(var_0, katsuya);
    add(var_5, var_5, var_0);
    bez(var_0, label_34);
    ref_30 = spriteLoad(sprite_d);
    wait(ref_30);
    unitSpawn(katsuya, sprite_d, 727, 0, -1250, south, none);
    unitTriggerSet(katsuya, B_KATUYYY, 255, 1);
  label_34:
    partyMemberCheck(var_0, baofu);
    add(var_5, var_5, var_0);
    bez(var_0, label_3b);
    ref_37 = spriteLoad(sprite_13);
    wait(ref_37);
    unitSpawn(baofu, sprite_13, 1274, 0, -1227, east, none);
    unitTriggerSet(baofu, B_PAO, 255, 1);
  label_3b:
    partyMemberCheck(var_0, nanjo);
    add(var_5, var_5, var_0);
    bez(var_0, label_42);
    ref_3e = spriteLoad(sprite_1f);
    wait(ref_3e);
    unitSpawn(nanjo, sprite_1f, 1057, 0, -1380, east, none);
    unitTriggerSet(nanjo, B_NANJ, 255, 1);
  label_42:
    partyMemberCheck(var_0, elly);
    add(var_5, var_5, var_0);
    bez(var_0, label_49);
    ref_45 = spriteLoad(sprite_23);
    wait(ref_45);
    unitSpawn(elly, sprite_23, 562, 0, -1161, west, none);
    unitTriggerSet(elly, B_ERI, 255, 1);
  label_49:
    partyMemberCheck(var_0, tatsuya);
    add(var_5, var_5, var_0);
    bez(var_0, label_57);
    bitGet(var_0, bit_c67);
    bne(var_0, 0, label_4f);
    b(label_52);
  label_4f:
    bne(var_0, 1, label_52);
    b(label_65);
    b(label_52);
  label_52:
    ref_52 = spriteLoad(sprite_18);
    wait(ref_52);
    unitSpawn(tatsuya, sprite_18, 700, 0, -1458, south, none);
    unitTriggerSet(tatsuya, B_TATU, 255, 1);
    b(label_65);
  label_57:
    bitGet(var_0, EBIT_E009F);
    bne(var_0, 0, label_63);
    bitGet(var_0, EBIT_E008C);
    bne(var_0, 0, label_5c);
    b(label_62);
  label_5c:
    bne(var_0, 1, label_62);
    ref_5d = spriteLoad(sprite_18);
    wait(ref_5d);
    unitSpawn(tatsuya, sprite_18, 700, 0, -1458, south, none);
    unitTriggerSet(tatsuya, B_TATU, 255, 1);
    b(label_62);
  label_62:
    b(label_65);
  label_63:
    bne(var_0, 1, label_65);
    b(label_65);
  label_65:
    boutrange(var_5, 0, 4, label_68);
    li(var_0, 0);
    b(label_6d);
  label_68:
    ref_68 = dialogAlloc();
    ref_69 = msgShow(msg_0);
/***************************************
There are more than 4 in your party.
[tab]It’ll hang at this rate.
[tab]Contact Kaneda or Kataoka.
[wait][clear]
***************************************/
    wait(ref_69);
    dialogFree(ref_68);
    b(label_6d);
  label_6d:
    bitGet(var_0, EBIT_E003E);
    bne(var_0, 0, label_79);
    bitGet(var_0, EBIT_E0038);
    bne(var_0, 0, label_72);
    b(label_78);
  label_72:
    bne(var_0, 1, label_78);
    ref_73 = spriteLoad(sprite_6a);
    wait(ref_73);
    unitSpawn(makimura, sprite_6a, 1026, 0, -1206, south, none);
    unitTriggerSet(makimura, SAGIBOX, 255, 1);
    b(label_78);
  label_78:
    b(label_7b);
  label_79:
    bne(var_0, 1, label_7b);
    b(label_7b);
  label_7b:
    bitGet(var_0, EBIT_END_EIKITI);
    bnz(var_0, label_83);
    bitGet(var_0, EBIT_E0050);
    bez(var_0, label_83);
    ref_7f = spriteLoad(sprite_27);
    wait(ref_7f);
    unitSpawn(npc1, sprite_27, 682, 0, -1418, south, none);
    unitTriggerSet(npc1, EIKITI, 255, 1);
  label_83:
    ref_83 = spriteLoad(sprite_a8);
    wait(ref_83);
    bitGet(var_0, MBIT_HI_TRISHOKUJI);
    bne(var_0, 0, label_8a);
    unitSpawn3d(shopkeeper, sprite_a8, 898, -80, -790, east, none);
    unitFace(shopkeeper, north);
    b(label_8e);
  label_8a:
    bne(var_0, 1, label_8e);
    unitSpawn3d(shopkeeper, sprite_a8, 898, -40, -846, east, none);
    unitFace(shopkeeper, north);
    b(label_8e);
  label_8e:
    unitAnimationPlay(shopkeeper, animation_b, 1);
    bitGet(var_0, MBIT_TORI2TORI);
    bne(var_0, 0, label_d4);
    unknownVar1(var_0);
    bne(var_0, 514, label_97);
    dngRoomSet(272);
    dngRoomDraw();
    cameraSetNorth(west);
    b(label_d3);
  label_97:
    bne(var_0, 780, label_9c);
    dngRoomSet(296);
    dngRoomDraw();
    cameraSetNorth(west);
    b(label_d3);
  label_9c:
    bne(var_0, 1029, label_a1);
    dngRoomSet(274);
    dngRoomDraw();
    cameraSetNorth(west);
    b(label_d3);
  label_a1:
    bne(var_0, 1541, label_a6);
    dngRoomSet(275);
    dngRoomDraw();
    cameraSetNorth(west);
    b(label_d3);
  label_a6:
    bne(var_0, 2050, label_ab);
    dngRoomSet(276);
    dngRoomDraw();
    cameraSetNorth(west);
    b(label_d3);
  label_ab:
    bne(var_0, 2570, label_b0);
    dngRoomSet(278);
    dngRoomDraw();
    cameraSetNorth(west);
    b(label_d3);
  label_b0:
    bne(var_0, 2826, label_b5);
    dngRoomSet(280);
    dngRoomDraw();
    cameraSetNorth(south);
    b(label_d3);
  label_b5:
    bne(var_0, 3073, label_ba);
    dngRoomSet(281);
    dngRoomDraw();
    cameraSetNorth(east);
    b(label_d3);
  label_ba:
    bne(var_0, 3338, label_bf);
    dngRoomSet(282);
    dngRoomDraw();
    cameraSetNorth(north);
    b(label_d3);
  label_bf:
    bne(var_0, 3618, label_c4);
    dngRoomSet(284);
    dngRoomDraw();
    cameraSetNorth(north);
    b(label_d3);
  label_c4:
    bne(var_0, 3855, label_c9);
    dngRoomSet(285);
    dngRoomDraw();
    cameraSetNorth(west);
    b(label_d3);
  label_c9:
    bne(var_0, 4871, label_ce);
    dngRoomSet(288);
    dngRoomDraw();
    cameraSetNorth(south);
    b(label_d3);
  label_ce:
    bne(var_0, 5889, label_d3);
    dngRoomSet(290);
    dngRoomDraw();
    cameraSetNorth(north);
    b(label_d3);
  label_d3:
    b(label_d8);
  label_d4:
    bne(var_0, 1, label_d8);
    dngRoomSet(286);
    dngRoomDraw();
    b(label_d8);
  label_d8:
    cameraSet(southwest, 901, 0, -1486);
    ref_d9 = spriteLoad(sprite_0);
    wait(ref_d9);
    ref_db = spriteLoad(sprite_2);
    wait(ref_db);
    playerInit(south);
    controlDisable();
    bitGet(var_0, MBIT_HI_TRISHOKUJI);
    bne(var_0, 0, label_10a);
    envTriggerSet(SHOPBOX, 56, 1, line, coll_6);
    envTriggerSet(SHOPBOX, 56, 1, line, coll_7);
    envTriggerSet(SHOPBOX, 56, 1, line, coll_8);
    objCollisionLink(collision_1, coll_4, obj_2);
    objVisible(obj_2, false);
    objVisible(obj_3, false);
    objVisible(obj_4, false);
    objVisible(obj_5, false);
    objVisible(obj_6, false);
    objVisible(obj_7, false);
    objVisible(obj_8, false);
    objVisible(obj_9, false);
    objVisible(obj_a, false);
    objVisible(obj_b, false);
    objVisible(obj_c, false);
    objVisible(obj_d, false);
    objVisible(obj_e, false);
    objVisible(obj_f, false);
    objVisible(obj_10, false);
    objVisible(obj_11, false);
    objVisible(obj_12, false);
    objVisible(obj_13, false);
    objVisible(obj_14, false);
    objVisible(obj_15, false);
    objVisible(obj_16, false);
    objVisible(obj_17, false);
    objVisible(obj_18, false);
    objVisible(obj_19, false);
    objVisible(obj_1a, false);
    objVisible(obj_1b, false);
    objVisible(obj_1c, false);
    objVisible(obj_1d, false);
    objVisible(obj_1e, false);
    objVisible(obj_1f, false);
    objVisible(obj_20, false);
    objVisible(obj_21, false);
    objVisible(obj_22, false);
    objVisible(obj_23, false);
    objVisible(obj_24, false);
    objVisible(obj_25, false);
    b(label_10d);
  label_10a:
    bne(var_0, 1, label_10d);
    envTriggerSet(SHOPBOX, 56, 1, collision_1, coll_4);
    b(label_10d);
  label_10d:
    screenEffectUnknown();
    screenFadeInner(rgb(0,0,0), 6, true);
    screenFadeOuter(rgb(0,0,0), 6, true);
    unitIdleOnAll();
    screenFadeWait(inner);
    screenFadeWait(outer);
    controlEnable();
}

function B_URARATI()
{
    controlDisable();
    bitGet(var_0, LBIT_0003);
    bne(var_0, 0, label_119);
    b(label_11c);
  label_119:
    bne(var_0, 1, label_11c);
    b(label_13e);
    b(label_11c);
  label_11c:
    bitGet(var_0, MBIT_TRI_ISATU);
    bnz(var_0, label_12e);
    unitFacePlayer(ulala);
    ref_11f = bustupLoad(bustup_18);
    bustupWait(ref_11f);
    ref_121 = bustupAlloc(ref_11f, left, rgb(0,0,0));
    bustupFade(ref_121, rgb(128,0,0), 30);
    ref_123 = dialogAlloc();
    ref_124 = msgShow(msg_1);
/***************************************
[color(yellow)]Ulala[color(white)]
[tab]Wow♥... Look Ma-ya, a fairy!!
[tab]I’ve never seen one before!!
[tab]Should I take a picture?
[wait][clear]
***************************************/
    unitAnimationPlay(ulala, animation_30, 1);
    wait(ref_124);
    unitAnimationPlay(ulala, animation_a, 1);
    dialogFree(ref_123);
    ref_129 = bustupFade(ref_121, rgb(0,0,0), 10);
    bustupWait(ref_129);
    bustupFree(ref_121);
    unitRestoreFacing(ulala);
    b(label_14d);
  label_12e:
    unitFacePlayer(ulala);
    ref_12f = bustupLoad(bustup_19);
    bustupWait(ref_12f);
    ref_131 = bustupAlloc(ref_12f, left, rgb(0,0,0));
    bustupFade(ref_131, rgb(128,0,0), 30);
    ref_133 = dialogAlloc();
    ref_134 = msgShow(msg_2);
/***************************************
[color(yellow)]Ulala[color(white)]
[tab]Wa... She’s charging us?
[tab]She has a cute face, but what
[tab]a money-grubbing fairy!
[wait][clear]
***************************************/
    unitAnimationPlay(ulala, animation_2f, 1);
    wait(ref_134);
    unitAnimationPlay(ulala, animation_a, 1);
    dialogFree(ref_133);
    ref_139 = bustupFade(ref_131, rgb(0,0,0), 10);
    bustupWait(ref_139);
    bustupFree(ref_131);
    unitRestoreFacing(ulala);
    b(label_14d);
  label_13e:
    unitFacePlayer(ulala);
    ref_13f = bustupLoad(bustup_18);
    bustupWait(ref_13f);
    ref_141 = bustupAlloc(ref_13f, left, rgb(0,0,0));
    bustupFade(ref_141, rgb(128,0,0), 30);
    ref_143 = dialogAlloc();
    ref_144 = msgShow(msg_3);
/***************************************
[color(yellow)]Ulala[color(white)]
[tab]This place is expensive as usual. Wouldn’t it be 
[tab]nice to get a discount once in a while? Do you think 
[tab]I could pressure her into giving us a loyalty card?
[wait][clear]
***************************************/
    unitAnimationPlay(ulala, animation_30, 1);
    wait(ref_144);
    unitAnimationPlay(ulala, animation_a, 1);
    dialogFree(ref_143);
    ref_149 = bustupFade(ref_141, rgb(0,0,0), 10);
    bustupWait(ref_149);
    bustupFree(ref_141);
    unitRestoreFacing(ulala);
  label_14d:
    controlEnable();
}

function B_KATUYYY()
{
    controlDisable();
    bitGet(var_0, LBIT_0003);
    bne(var_0, 0, label_153);
    b(label_156);
  label_153:
    bne(var_0, 1, label_156);
    b(label_195);
    b(label_156);
  label_156:
    bitGet(var_0, MBIT_TRI_ISATU);
    bnz(var_0, label_168);
    unitFacePlayer(katsuya);
    ref_159 = bustupLoad(bustup_25);
    bustupWait(ref_159);
    ref_15b = bustupAlloc(ref_159, left, rgb(0,0,0));
    bustupFade(ref_15b, rgb(128,0,0), 30);
    ref_15d = dialogAlloc();
    ref_15e = msgShow(msg_4);
/***************************************
[color(yellow)]Katsuya[color(white)]
[tab]W... What is this room? It feels
[tab]the same as Philemon’s dimension...
[tab]Is this another world, too...?
[wait][clear]
***************************************/
    unitAnimationPlay(katsuya, animation_28, 1);
    wait(ref_15e);
    dialogFree(ref_15d);
    unitAnimationPlay(katsuya, animation_a, 1);
    ref_163 = bustupFade(ref_15b, rgb(0,0,0), 10);
    bustupWait(ref_163);
    bustupFree(ref_15b);
    unitRestoreFacing(katsuya);
    b(label_1a4);
  label_168:
    bitGet(var_0, MBIT_TRI_KOWAI01);
    bnz(var_0, label_185);
    unitFacePlayer(katsuya);
    ref_16b = bustupLoad(bustup_21);
    bustupWait(ref_16b);
    ref_16d = bustupAlloc(ref_16b, left, rgb(0,0,0));
    bustupFade(ref_16d, rgb(128,0,0), 30);
    ref_16f = dialogAlloc();
    ref_170 = msgShow(msg_5);
/***************************************
[color(yellow)]Katsuya[color(white)]
[tab]Places where an incident occurs have
[tab]a peculiar atmosphere. That’s why
[tab]eerie stories are based on those areas.
[wait][clear]
***************************************/
    unitAnimationPlay(katsuya, animation_2d, 1);
    wait(ref_170);
    ref_173 = bustupFade(ref_16d, rgb(0,0,0), 10);
    bustupWait(ref_173);
    bustupFree(ref_16d);
    ref_176 = bustupLoad(bustup_24);
    bustupWait(ref_176);
    ref_178 = bustupAlloc(ref_176, left, rgb(0,0,0));
    bustupFade(ref_178, rgb(128,0,0), 30);
    ref_17a = msgShow(msg_6);
/***************************************
[color(yellow)]Katsuya[color(white)]
[tab]There are even stories going around
[tab]about that bizarre murder case. Geez,
[tab]even if it’s a joke, I wish they’d stop it.
[wait][clear]
***************************************/
    unitAnimationPlay(katsuya, animation_6, 1);
    wait(ref_17a);
    dialogFree(ref_16f);
    unitAnimationPlay(katsuya, animation_a, 1);
    ref_17f = bustupFade(ref_178, rgb(0,0,0), 10);
    bustupWait(ref_17f);
    bustupFree(ref_178);
    unitRestoreFacing(katsuya);
    bitSet(MBIT_TRI_KOWAI01);
    b(label_1a4);
  label_185:
    unitFacePlayer(katsuya);
    ref_186 = bustupLoad(bustup_21);
    bustupWait(ref_186);
    ref_188 = bustupAlloc(ref_186, left, rgb(0,0,0));
    bustupFade(ref_188, rgb(128,0,0), 30);
    ref_18a = dialogAlloc();
    ref_18b = msgShow(msg_7);
/***************************************
[color(yellow)]Katsuya[color(white)]
[tab]Necessity knows no law... huh.
[tab]But those prices are outrageous...
[tab]Isn’t there anything we can do about it?
[wait][clear]
***************************************/
    unitAnimationPlay(katsuya, animation_1a, 1);
    wait(ref_18b);
    dialogFree(ref_18a);
    unitAnimationPlay(katsuya, animation_a, 1);
    ref_190 = bustupFade(ref_188, rgb(0,0,0), 10);
    bustupWait(ref_190);
    bustupFree(ref_188);
    unitRestoreFacing(katsuya);
    b(label_1a4);
  label_195:
    unitFacePlayer(katsuya);
    ref_196 = bustupLoad(bustup_21);
    bustupWait(ref_196);
    ref_198 = bustupAlloc(ref_196, left, rgb(0,0,0));
    bustupFade(ref_198, rgb(128,0,0), 30);
    ref_19a = dialogAlloc();
    ref_19b = msgShow(msg_8);
/***************************************
[color(yellow)]Katsuya[color(white)]
[tab]If only we could draw water from that spring...
[tab]No, nothing comes without a price.
[tab]If we’re not careful she’ll rob us blind.
[wait][clear]
***************************************/
    unitAnimationPlay(katsuya, animation_1a, 1);
    wait(ref_19b);
    dialogFree(ref_19a);
    unitAnimationPlay(katsuya, animation_a, 1);
    ref_1a0 = bustupFade(ref_198, rgb(0,0,0), 10);
    bustupWait(ref_1a0);
    bustupFree(ref_198);
    unitRestoreFacing(katsuya);
  label_1a4:
    controlEnable();
}

function B_PAO()
{
    controlDisable();
    bitGet(var_0, LBIT_0003);
    bne(var_0, 0, label_1aa);
    b(label_1ad);
  label_1aa:
    bne(var_0, 1, label_1ad);
    b(label_1e5);
    b(label_1ad);
  label_1ad:
    bitGet(var_0, MBIT_TRI_ISATU);
    bnz(var_0, label_1bf);
    unitFacePlayer(baofu);
    ref_1b0 = bustupLoad(bustup_2d);
    bustupWait(ref_1b0);
    ref_1b2 = bustupAlloc(ref_1b0, left, rgb(0,0,0));
    bustupFade(ref_1b2, rgb(128,0,0), 30);
    ref_1b4 = dialogAlloc();
    ref_1b5 = msgShow(msg_9);
/***************************************
[color(yellow)]Baofu[color(white)]
[tab]I don’t know much about this room.
[tab]That flying bug is the owner, right?
[tab]Why don’t you ask her?
[wait][clear]
***************************************/
    unitAnimationPlay(baofu, animation_2d, 1);
    wait(ref_1b5);
    unitAnimationPlay(baofu, animation_a, 1);
    dialogFree(ref_1b4);
    ref_1ba = bustupFade(ref_1b2, rgb(0,0,0), 10);
    bustupWait(ref_1ba);
    bustupFree(ref_1b2);
    unitRestoreFacing(baofu);
    b(label_1f4);
  label_1bf:
    bitGet(var_0, MBIT_TRI_KOWAI02);
    bnz(var_0, label_1d5);
    unitFacePlayer(baofu);
    ref_1c2 = bustupLoad(bustup_2d);
    bustupWait(ref_1c2);
    ref_1c4 = bustupAlloc(ref_1c2, left, rgb(0,0,0));
    bustupFade(ref_1c4, rgb(128,0,0), 30);
    ref_1c6 = dialogAlloc();
    ref_1c7 = msgShow(msg_10);
/***************************************
[color(yellow)]Baofu[color(white)]
[tab]A money-grubbing fairy and talkative
[tab]demons... After all of this and all those
[tab]ghost stories, they seem like lies, huh?
[wait][clear]
***************************************/
    unitAnimationPlay(baofu, animation_1a, 1);
    wait(ref_1c7);
    ref_1ca = msgShow(msg_11);
/***************************************
[color(yellow)]Baofu[color(white)]
[tab]But, there was one story that’s
[tab]really scary. Even I couldn’t sleep.
[tab]I’ll tell ya when I feel like it.
[wait][clear]
***************************************/
    unitAnimationPlay(baofu, animation_2d, 1);
    wait(ref_1ca);
    unitAnimationPlay(baofu, animation_a, 1);
    dialogFree(ref_1c6);
    ref_1cf = bustupFade(ref_1c4, rgb(0,0,0), 10);
    bustupWait(ref_1cf);
    bustupFree(ref_1c4);
    unitRestoreFacing(baofu);
    bitSet(MBIT_TRI_KOWAI02);
    b(label_1f4);
  label_1d5:
    unitFacePlayer(baofu);
    ref_1d6 = bustupLoad(bustup_2d);
    bustupWait(ref_1d6);
    ref_1d8 = bustupAlloc(ref_1d6, left, rgb(0,0,0));
    bustupFade(ref_1d8, rgb(128,0,0), 30);
    ref_1da = dialogAlloc();
    ref_1db = msgShow(msg_12);
/***************************************
[color(yellow)]Baofu[color(white)]
[tab]A fairy with a greed for money... huh.
[tab]Hmph, what an empty dream. In the end,
[tab]dreams are just people’s delusions...
[wait][clear]
***************************************/
    unitAnimationPlay(baofu, animation_1a, 1);
    wait(ref_1db);
    unitAnimationPlay(baofu, animation_a, 1);
    dialogFree(ref_1da);
    ref_1e0 = bustupFade(ref_1d8, rgb(0,0,0), 10);
    bustupWait(ref_1e0);
    bustupFree(ref_1d8);
    unitRestoreFacing(baofu);
    b(label_1f4);
  label_1e5:
    unitFacePlayer(baofu);
    ref_1e6 = bustupLoad(bustup_2d);
    bustupWait(ref_1e6);
    ref_1e8 = bustupAlloc(ref_1e6, left, rgb(0,0,0));
    bustupFade(ref_1e8, rgb(128,0,0), 30);
    ref_1ea = dialogAlloc();
    ref_1eb = msgShow(msg_13);
/***************************************
[color(yellow)]Baofu[color(white)]
[tab]She sure knows how to appears anywhere, 
[tab]that miser. Now if she could use that ability 
[tab]to transport us, that’d be something.
[wait][clear][color(yellow)]Baofu[color(white)]
[tab]Well, she’d probably charge 
[tab]more than a midnight cab though. 
[wait][clear]
***************************************/
    unitAnimationPlay(baofu, animation_1a, 1);
    wait(ref_1eb);
    unitAnimationPlay(baofu, animation_a, 1);
    dialogFree(ref_1ea);
    ref_1f0 = bustupFade(ref_1e8, rgb(0,0,0), 10);
    bustupWait(ref_1f0);
    bustupFree(ref_1e8);
    unitRestoreFacing(baofu);
  label_1f4:
    controlEnable();
}

function B_NANJ()
{
    controlDisable();
    bitGet(var_0, LBIT_0003);
    bne(var_0, 0, label_1fa);
    b(label_1fd);
  label_1fa:
    bne(var_0, 1, label_1fd);
    b(label_21d);
    b(label_1fd);
  label_1fd:
    bitGet(var_0, MBIT_TRI_ISATU);
    bnz(var_0, label_20d);
    ref_1ff = bustupLoad(bustup_36);
    bustupWait(ref_1ff);
    ref_201 = bustupAlloc(ref_1ff, left, rgb(0,0,0));
    bustupFade(ref_201, rgb(128,0,0), 30);
    ref_203 = dialogAlloc();
    ref_204 = msgShow(msg_14);
/***************************************
[color(yellow)]Nanjo[color(white)]
[tab]...Her again... How does she prepare
[tab]a fountain everywhere we go?
[tab]She has much more mobility than us...
[wait][clear]
***************************************/
    unitAnimationPlay(nanjo, animation_6, 1);
    wait(ref_204);
    unitAnimationPlay(nanjo, animation_a, 1);
    dialogFree(ref_203);
    ref_209 = bustupFade(ref_201, rgb(0,0,0), 10);
    bustupWait(ref_209);
    bustupFree(ref_201);
    b(label_22c);
  label_20d:
    unitFacePlayer(nanjo);
    ref_20e = bustupLoad(bustup_36);
    bustupWait(ref_20e);
    ref_210 = bustupAlloc(ref_20e, left, rgb(0,0,0));
    bustupFade(ref_210, rgb(128,0,0), 30);
    ref_212 = dialogAlloc();
    ref_213 = msgShow(msg_15);
/***************************************
[color(yellow)]Nanjo[color(white)]
[tab]We too have been through hard times due to
[tab]that fairy... She seems to have grown a
[tab]little, but her greed is just as before...
[wait][clear]
***************************************/
    unitAnimationPlay(nanjo, animation_2d, 1);
    wait(ref_213);
    unitAnimationPlay(nanjo, animation_a, 1);
    dialogFree(ref_212);
    ref_218 = bustupFade(ref_210, rgb(0,0,0), 10);
    bustupWait(ref_218);
    bustupFree(ref_210);
    unitRestoreFacing(nanjo);
    b(label_22c);
  label_21d:
    unitFacePlayer(nanjo);
    ref_21e = bustupLoad(bustup_36);
    bustupWait(ref_21e);
    ref_220 = bustupAlloc(ref_21e, left, rgb(0,0,0));
    bustupFade(ref_220, rgb(128,0,0), 30);
    ref_222 = dialogAlloc();
    ref_223 = msgShow(msg_16);
/***************************************
[color(yellow)]Nanjo[color(white)]
[tab]Good grief, I never thought I would meet her again.
[tab]If I don’t keep an eye on her, The Nanjo 
[tab]conglomerate could be completely crushed...
[wait][clear]
***************************************/
    unitAnimationPlay(nanjo, animation_2d, 1);
    wait(ref_223);
    unitAnimationPlay(nanjo, animation_a, 1);
    dialogFree(ref_222);
    ref_228 = bustupFade(ref_220, rgb(0,0,0), 10);
    bustupWait(ref_228);
    bustupFree(ref_220);
    unitRestoreFacing(nanjo);
  label_22c:
    controlEnable();
}

function B_ERI()
{
    controlDisable();
    bitGet(var_0, LBIT_0003);
    bne(var_0, 0, label_232);
    b(label_235);
  label_232:
    bne(var_0, 1, label_235);
    b(label_25a);
    b(label_235);
  label_235:
    bitGet(var_0, MBIT_TRI_ISATU);
    bnz(var_0, label_24a);
    unitFacePlayer(elly);
    ref_238 = bustupLoad(bustup_3d);
    bustupWait(ref_238);
    ref_23a = bustupAlloc(ref_238, left, rgb(0,0,0));
    bustupFade(ref_23a, rgb(128,0,0), 30);
    ref_23c = dialogAlloc();
    ref_23d = msgShow(msg_17);
/***************************************
[color(yellow)]Elly[color(white)]
[tab]Don’t be fooled by her cute looks.
[tab]She’s an unbelievable capitalist.

***************************************/
    unitAnimationPlay(elly, animation_2d, 1);
    wait(ref_23d);
    ref_240 = msgShow(msg_18);
/***************************************
[tab]I never thought I’d meet her again...
[wait][clear]
***************************************/
    unitLookAtUnit(elly, shopkeeper);
    wait(ref_240);
    unitAnimationPlay(elly, animation_a, 1);
    dialogFree(ref_23c);
    ref_245 = bustupFade(ref_23a, rgb(0,0,0), 10);
    bustupWait(ref_245);
    bustupFree(ref_23a);
    unitRestoreFacing(elly);
    b(label_269);
  label_24a:
    unitFacePlayer(elly);
    ref_24b = bustupLoad(bustup_3f);
    bustupWait(ref_24b);
    ref_24d = bustupAlloc(ref_24b, left, rgb(0,0,0));
    bustupFade(ref_24d, rgb(128,0,0), 30);
    ref_24f = dialogAlloc();
    ref_250 = msgShow(msg_19);
/***************************************
[color(yellow)]Elly[color(white)]
[tab]No matter how injured we are, she
[tab]won’t heal us unless we have money.
[tab]I’d understand if she were a demon, but...
[wait][clear]
***************************************/
    unitAnimationPlay(elly, animation_2f, 1);
    wait(ref_250);
    unitAnimationPlay(elly, animation_a, 1);
    dialogFree(ref_24f);
    ref_255 = bustupFade(ref_24d, rgb(0,0,0), 10);
    bustupWait(ref_255);
    bustupFree(ref_24d);
    unitRestoreFacing(elly);
    b(label_269);
  label_25a:
    unitFacePlayer(elly);
    ref_25b = bustupLoad(bustup_3f);
    bustupWait(ref_25b);
    ref_25d = bustupAlloc(ref_25b, left, rgb(0,0,0));
    bustupFade(ref_25d, rgb(128,0,0), 30);
    ref_25f = dialogAlloc();
    ref_260 = msgShow(msg_20);
/***************************************
[color(yellow)]Elly[color(white)]
[tab]I wonder when she’ll be able to go home...
[tab]If she goes back, could we have a 
[tab]pure-hearted fairy in her stead?
[wait][clear]
***************************************/
    unitAnimationPlay(elly, animation_2f, 1);
    wait(ref_260);
    unitAnimationPlay(elly, animation_a, 1);
    dialogFree(ref_25f);
    ref_265 = bustupFade(ref_25d, rgb(0,0,0), 10);
    bustupWait(ref_265);
    bustupFree(ref_25d);
    unitRestoreFacing(elly);
  label_269:
    controlEnable();
}

function B_TATU()
{
    controlDisable();
    bitGet(var_0, LBIT_0003);
    bne(var_0, 0, label_26f);
    b(label_272);
  label_26f:
    bne(var_0, 1, label_272);
    b(label_293);
    b(label_272);
  label_272:
    bitGet(var_0, EBIT_E009F);
    bne(var_0, 0, label_283);
    ref_274 = bustupLoad(bustup_10);
    bustupWait(ref_274);
    ref_276 = bustupAlloc(ref_274, right, rgb(0,0,0));
    bustupFade(ref_276, rgb(128,0,0), 30);
    bustupFlip(ref_276, true);
    ref_279 = dialogAlloc();
    ref_27a = msgShow(msg_21);
/***************************************
[color(yellow)][tatsuya][color(white)]
[tab]There she is...
[tab]The money-hungry fairy...
[tab]Even on "This Side" she’s still the same...
[wait][clear]
***************************************/
    unitAnimationPlay(tatsuya, animation_6, 1);
    wait(ref_27a);
    dialogFree(ref_279);
    unitAnimationPlay(tatsuya, animation_a, 1);
    ref_27f = bustupFade(ref_276, rgb(0,0,0), 10);
    bustupWait(ref_27f);
    bustupFree(ref_276);
    b(label_292);
  label_283:
    bne(var_0, 1, label_292);
    ref_284 = bustupLoad(bustup_10);
    bustupWait(ref_284);
    ref_286 = bustupAlloc(ref_284, left, rgb(0,0,0));
    bustupFade(ref_286, rgb(128,0,0), 30);
    ref_288 = dialogAlloc();
    ref_289 = msgShow(msg_22);
/***************************************
[color(yellow)][tatsuya][color(white)]
[tab]There she is...
[tab]The money-hungry fairy...
[tab]Even on "This Side" she’s still the same...
[wait][clear]
***************************************/
    unitAnimationPlay(tatsuya, animation_6, 1);
    wait(ref_289);
    dialogFree(ref_288);
    unitAnimationPlay(tatsuya, animation_a, 1);
    ref_28e = bustupFade(ref_286, rgb(0,0,0), 10);
    bustupWait(ref_28e);
    bustupFree(ref_286);
    b(label_292);
  label_292:
    b(label_2a0);
  label_293:
    ref_293 = bustupLoad(bustup_10);
    bustupWait(ref_293);
    ref_295 = bustupAlloc(ref_293, left, rgb(0,0,0));
    bustupFade(ref_295, rgb(128,0,0), 30);
    ref_297 = dialogAlloc();
    ref_298 = msgShow(msg_23);
/***************************************
[color(yellow)][tatsuya][color(white)]
[tab]Will the day ever come that that fairy does 
[tab]a true good deed? Maybe she doesn’t
[tab]realize it because no one’s told her?
[wait][clear][color(yellow)][tatsuya][color(white)]
[tab]...Should we say something?
[wait][clear]
***************************************/
    unitAnimationPlay(tatsuya, animation_6, 1);
    wait(ref_298);
    dialogFree(ref_297);
    unitAnimationPlay(tatsuya, animation_a, 1);
    ref_29d = bustupFade(ref_295, rgb(0,0,0), 10);
    bustupWait(ref_29d);
    bustupFree(ref_295);
  label_2a0:
    controlEnable();
}

function SAGIBOX()
{
    controlDisable();
    unitFacePlayer(makimura);
    ref_2a4 = bustupLoad(bustup_d4);
    bustupWait(ref_2a4);
    ref_2a6 = bustupAlloc(ref_2a4, right, rgb(0,0,0));
    bustupFade(ref_2a6, rgb(128,0,0), 30);
    ref_2a8 = dialogAlloc();
    ref_2a9 = msgShow(msg_24);
/***************************************
[color(yellow)]Makimura[color(white)]
[tab]Huh? That fairy is cute...
[tab]To meet up with such a cute chick here♥...
[tab]I’ll have to hit on her later.
[wait][clear]
***************************************/
    unitAnimationPlay(makimura, animation_24, 1);
    wait(ref_2a9);
    unitAnimationPlay(makimura, animation_0, 1);
    dialogFree(ref_2a8);
    ref_2ae = bustupFade(ref_2a6, rgb(0,0,0), 10);
    bustupWait(ref_2ae);
    bustupFree(ref_2a6);
    unitRestoreFacing(makimura);
    controlEnable();
}

function EIKITI()
{
    controlDisable();
    unitFacePlayer(npc1);
    ref_2b6 = bustupLoad(bustup_116);
    bustupWait(ref_2b6);
    ref_2b8 = bustupAlloc(ref_2b6, right, rgb(0,0,0));
    bustupFade(ref_2b8, rgb(128,0,0), 30);
    ref_2ba = dialogAlloc();
    ref_2bb = msgShow(msg_25);
/***************************************
[color(yellow)]Eikichi[color(white)]
[tab]Why... I feel I’ve seen her somewhere...
[tab]I feel as if I’ve had a rough time
[tab]because of her...
[wait][clear]
***************************************/
    unitAnimationPlay(npc1, animation_2d, 1);
    wait(ref_2bb);
    unitAnimationPlay(npc1, animation_a, 1);
    dialogFree(ref_2ba);
    ref_2c0 = bustupFade(ref_2b8, rgb(0,0,0), 10);
    bustupWait(ref_2c0);
    bustupFree(ref_2b8);
    unitRestoreFacing(npc1);
    controlEnable();
}

function SHOPBOX()
{
    controlDisable();
    ref_2c7 = shopOverlayInit();
    unitFacePlayer(shopkeeper);
    bitGet(var_0, MBIT_HI_TRIKAISIN);
    bne(var_0, 0, label_2e7);
    bitGet(var_0, MBIT_TRI_ISATU);
    bne(var_0, 0, label_2d6);
    bitGet(var_0, MBIT_HI_TRISHOKUJI);
    bne(var_0, 0, label_2d0);
    b(label_2d3);
  label_2d0:
    bne(var_0, 1, label_2d3);
    bitSet(MBIT_TRI_ICE);
    b(label_2d3);
  label_2d3:
    bitSet(MBIT_TRI_ISATU);
    b(label_2fb);
    b(label_2e6);
  label_2d6:
    bne(var_0, 1, label_2e6);
    bitGet(var_0, MBIT_HI_TRISHOKUJI);
    bne(var_0, 0, label_2db);
    b(label_3e5);
    b(label_2e5);
  label_2db:
    bne(var_0, 1, label_2e5);
    bitGet(var_0, MBIT_TRI_ICE);
    bne(var_0, 0, label_2e1);
    bitSet(MBIT_TRI_ICE);
    b(label_333);
    b(label_2e4);
  label_2e1:
    bne(var_0, 1, label_2e4);
    b(label_3e5);
    b(label_2e4);
  label_2e4:
    b(label_2e5);
  label_2e5:
    b(label_2e6);
  label_2e6:
    b(label_2fa);
  label_2e7:
    bne(var_0, 1, label_2fa);
    bitGet(var_0, MBIT_TRI_HENKEN);
    bne(var_0, 0, label_2f6);
    rand(var_0, 4);
    boutrange(var_0, 0, 1, label_2f0);
    bitSet(MBIT_TRI_NESAGARI);
    bitSet(MBIT_TRI_HENKEN);
    b(label_3ab);
    b(label_2f5);
  label_2f0:
    boutrange(var_0, 2, 4, label_2f5);
    bitSet(MBIT_TRI_NEAGARI);
    bitSet(MBIT_TRI_HENKEN);
    b(label_365);
    b(label_2f5);
  label_2f5:
    b(label_2f9);
  label_2f6:
    bne(var_0, 1, label_2f9);
    b(label_3e5);
    b(label_2f9);
  label_2f9:
    b(label_2fa);
  label_2fa:
    b(label_3e5);
  label_2fb:
    ref_2fb = bustupLoad(bustup_e4);
    bustupWait(ref_2fb);
    ref_2fd = bustupAlloc(ref_2fb, right, rgb(0,0,0));
    bustupFade(ref_2fd, rgb(128,0,0), 30);
    ref_2ff = dialogAlloc();
    ref_300 = msgShow(msg_26);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]This world is give and take...!
[tab]Oh! ...You’re new here, right?[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_7, 1);
    sync();
    wait(ref_300);
    ref_30d = msgShow(msg_27);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]I’m Trish.
[tab]I protect this place of recovery.
[tab]I heal your wounded bodies.[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_7, 1);
    sync();
    wait(ref_30d);
    ref_31a = msgShow(msg_28);
/***************************************
[color(yellow)]Trish[color(green)]
[tab]A stingy fairy who is obsessed with money.
[tab]She’s been banned from the fairy world and
[tab]can’t return until she does good, but...[color(white)][sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_a, 1);
    sync();
    wait(ref_31a);
    ref_31e = msgShow(msg_29);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Not for free, of course. This world
[tab]is give and take! You can recover from
[tab]anything, depending on your wallet![sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_c, 1);
    unitWait(shopkeeper);
    sync();
    wait(ref_31e);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_2ff);
    ref_32e = bustupFade(ref_2fd, rgb(0,0,0), 10);
    bustupWait(ref_32e);
    bustupFree(ref_2fd);
    wait(ref_2c7);
    b(label_424);
  label_333:
    ref_333 = bustupLoad(bustup_e4);
    bustupWait(ref_333);
    ref_335 = bustupAlloc(ref_333, right, rgb(0,0,0));
    bustupFade(ref_335, rgb(128,0,0), 30);
    ref_337 = dialogAlloc();
    ref_338 = msgShow(msg_30);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Hi! Welcome!!
[tab]You have got nice timing!!
[tab]I just started a new business!
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_338);
    ref_345 = msgShow(msg_31);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]I call it "Trish’s Ice Cream"!!
[tab]It’s very sweet!!
[tab]And delicious!!
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_a, 1);
    sync();
    wait(ref_345);
    ref_349 = msgShow(msg_32);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Once you eat it, you can’t stop!
[tab]It’s true!!
[tab]Eat up, and get brain-freeze♥...
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_349);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_337);
    ref_358 = bustupFade(ref_335, rgb(0,0,0), 10);
    bustupWait(ref_358);
    bustupFree(ref_335);
    wait(ref_2c7);
    bitGet(var_0, MBIT_TRI_NEAGARI);
    bne(var_0, 0, label_360);
    shopInventory(12, shopInventory_e);
    b(label_363);
  label_360:
    bne(var_0, 1, label_363);
    shopInventory(12, shopInventory_f);
    b(label_363);
  label_363:
    shopRate(100);
    b(label_424);
  label_365:
    ref_365 = bustupLoad(bustup_e4);
    bustupWait(ref_365);
    ref_367 = bustupAlloc(ref_365, right, rgb(0,0,0));
    bustupFade(ref_367, rgb(128,0,0), 30);
    ref_369 = dialogAlloc();
    ref_36a = msgShow(msg_33);
/***************************************
[color(yellow)]Trish[color(white)]
[tab](sigh)...
[tab]I’m actually regretting it...
[tab]What I’m regretting is the price...
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_6, 1);
    sync();
    wait(ref_36a);
    ref_36e = msgShow(msg_34);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]The price is out of line, isn’t it?
[tab]It’s not normal.
[tab]Why was it so...
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_36e);
    ref_37b = msgShow(msg_35);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Cheap...!
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_6, 1);
    sync();
    wait(ref_37b);
    ref_37f = msgShow(msg_36);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]It’s hard work moving this fountain...
[tab]Plus, that price was way too cheap.
[tab]I’m regretting it now...
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(6);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(6);
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(6);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(6);
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(6);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(6);
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(6);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_37f);
    ref_398 = msgShow(msg_37);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]I’m living a more vigorous business life!
[tab]Don’t you think THAT’s more like me?
[tab]I think so♥...
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_a, 1);
    sync();
    wait(ref_398);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_369);
    ref_39e = bustupFade(ref_367, rgb(0,0,0), 10);
    bustupWait(ref_39e);
    bustupFree(ref_367);
    wait(ref_2c7);
    bitGet(var_0, MBIT_TRI_NEAGARI);
    bne(var_0, 0, label_3a6);
    shopInventory(12, shopInventory_e);
    b(label_3a9);
  label_3a6:
    bne(var_0, 1, label_3a9);
    shopInventory(12, shopInventory_f);
    b(label_3a9);
  label_3a9:
    shopRate(200);
    b(label_424);
  label_3ab:
    ref_3ab = bustupLoad(bustup_e4);
    bustupWait(ref_3ab);
    ref_3ad = bustupAlloc(ref_3ab, right, rgb(0,0,0));
    bustupFade(ref_3ad, rgb(128,0,0), 30);
    ref_3af = dialogAlloc();
    ref_3b0 = msgShow(msg_38);
/***************************************
[color(yellow)]Trish[color(white)]
[tab](sigh)...
[tab]I’m actually regretting it...
[tab]What I’m regretting is the price...
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_6, 1);
    sync();
    wait(ref_3b0);
    ref_3b4 = msgShow(msg_39);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]The price is out of line, isn’t it?
[tab]It’s not normal.
[tab]Why was it so...
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_3b4);
    ref_3c1 = msgShow(msg_40);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Expensive...!
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_6, 1);
    sync();
    wait(ref_3c1);
    ref_3c5 = msgShow(msg_41);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]I can’t return to the fairy world unless I
[tab]do good deeds... I can’t be so greedy...
[tab]I’ll lower the price.
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_3c5);
    ref_3d2 = msgShow(msg_42);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]...But...
[tab]Just by a little bit...
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_6, 1);
    sync();
    wait(ref_3d2);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_3af);
    ref_3d8 = bustupFade(ref_3ad, rgb(0,0,0), 10);
    bustupWait(ref_3d8);
    bustupFree(ref_3ad);
    wait(ref_2c7);
    bitGet(var_0, MBIT_TRI_NEAGARI);
    bne(var_0, 0, label_3e0);
    shopInventory(12, shopInventory_e);
    b(label_3e3);
  label_3e0:
    bne(var_0, 1, label_3e3);
    shopInventory(12, shopInventory_f);
    b(label_3e3);
  label_3e3:
    shopRate(50);
    b(label_424);
  label_3e5:
    ref_3e5 = bustupLoad(bustup_e4);
    bustupWait(ref_3e5);
    ref_3e7 = bustupAlloc(ref_3e5, right, rgb(0,0,0));
    bustupFade(ref_3e7, rgb(128,0,0), 30);
    ref_3e9 = dialogAlloc();
    ref_3ea = msgShow(msg_43);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]This world is give and take...!
[tab]You can recover from anything, depending
[tab]on your money! What do you want?

***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_3ea);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_3e9);
    ref_3f9 = bustupFade(ref_3e7, rgb(0,0,0), 10);
    bustupWait(ref_3f9);
    bustupFree(ref_3e7);
    wait(ref_2c7);
    bitGet(var_0, MBIT_TRI_HENKEN);
    bne(var_0, 0, label_40d);
    bitGet(var_0, MBIT_HI_TRISHOKUJI);
    bne(var_0, 0, label_402);
    b(label_40c);
  label_402:
    bne(var_0, 1, label_40c);
    bitGet(var_0, MBIT_TRI_NEAGARI);
    bne(var_0, 0, label_407);
    shopInventory(12, shopInventory_e);
    b(label_40a);
  label_407:
    bne(var_0, 1, label_40a);
    shopInventory(12, shopInventory_f);
    b(label_40a);
  label_40a:
    shopRate(100);
    b(label_40c);
  label_40c:
    b(label_424);
  label_40d:
    bne(var_0, 1, label_424);
    bitGet(var_0, MBIT_TRI_NESAGARI);
    bne(var_0, 0, label_419);
    bitGet(var_0, MBIT_TRI_NEAGARI);
    bne(var_0, 0, label_414);
    shopInventory(12, shopInventory_e);
    b(label_417);
  label_414:
    bne(var_0, 1, label_417);
    shopInventory(12, shopInventory_f);
    b(label_417);
  label_417:
    shopRate(200);
    b(label_423);
  label_419:
    bne(var_0, 1, label_423);
    bitGet(var_0, MBIT_TRI_NEAGARI);
    bne(var_0, 0, label_41e);
    shopInventory(12, shopInventory_e);
    b(label_421);
  label_41e:
    bne(var_0, 1, label_421);
    shopInventory(12, shopInventory_f);
    b(label_421);
  label_421:
    shopRate(50);
    b(label_423);
  label_423:
    b(label_424);
  label_424:
    bitGet(var_0, MBIT_HI_TRISHOKUJI);
    bne(var_0, 0, label_453);
    choiceSetResult(2);
    op_105(3);
    ref_428 = bustupLoad(bustup_e4);
    bustupWait(ref_428);
    ref_42a = bustupAlloc(ref_428, right, rgb(0,0,0));
    bustupFade(ref_42a, rgb(128,0,0), 30);
    ref_42c = dialogAlloc();
    ref_42d = msgShow(msg_44);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]What’ll it be?
[choice(4)]Heal
Talk to Trish
Never mind
Leave
[end_choice][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_b, 1);
    wait(ref_42d);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    choiceGetResult(var_0);
    bne(var_0, 0, label_435);
    li(var_5, 0);
    b(label_44b);
  label_435:
    bne(var_0, 1, label_445);
    choiceSetResult(2);
    op_105(2);
    ref_438 = msgShow(msg_45);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Yeah, whaddaya want?
[choice(2)]Make small talk
Ask about healing spring
[end_choice][clear]
***************************************/
    wait(ref_438);
    choiceGetResult(var_0);
    bne(var_0, 0, label_43e);
    li(var_5, 1);
    b(label_444);
  label_43e:
    bne(var_0, 1, label_441);
    li(var_5, 2000);
    b(label_444);
  label_441:
    bne(var_0, 2, label_444);
    li(var_5, 1000);
    b(label_444);
  label_444:
    b(label_44b);
  label_445:
    bne(var_0, 2, label_448);
    li(var_5, 2);
    b(label_44b);
  label_448:
    bne(var_0, 3, label_44b);
    li(var_5, 3);
    b(label_44b);
  label_44b:
    unitAnimationPlay(shopkeeper, animation_0, 1);
    dialogFree(ref_42c);
    ref_44d = bustupFade(ref_42a, rgb(0,0,0), 10);
    bustupWait(ref_44d);
    bustupFree(ref_42a);
    ref_450 = shopOpen(11);
    wait(ref_450);
    b(label_484);
  label_453:
    bne(var_0, 1, label_484);
    choiceSetResult(3);
    op_105(3);
    ref_456 = bustupLoad(bustup_e4);
    bustupWait(ref_456);
    ref_458 = bustupAlloc(ref_456, right, rgb(0,0,0));
    bustupFade(ref_458, rgb(128,0,0), 30);
    ref_45a = dialogAlloc();
    ref_45b = msgShow(msg_46);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]What’ll it be?
[choice(5)]Heal
Dine in
Talk to Trish
Never mind
Leave
[end_choice][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_b, 1);
    wait(ref_45b);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    choiceGetResult(var_0);
    bne(var_0, 0, label_463);
    li(var_5, 0);
    b(label_47c);
  label_463:
    bne(var_0, 1, label_466);
    li(var_5, 1);
    b(label_47c);
  label_466:
    bne(var_0, 2, label_476);
    choiceSetResult(2);
    op_105(2);
    ref_469 = msgShow(msg_47);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Yeah, whaddaya want?
[choice(2)]Make small talk
Ask about healing spring
[end_choice][clear]
***************************************/
    wait(ref_469);
    choiceGetResult(var_0);
    bne(var_0, 0, label_46f);
    li(var_5, 2);
    b(label_475);
  label_46f:
    bne(var_0, 1, label_472);
    li(var_5, 2000);
    b(label_475);
  label_472:
    bne(var_0, 2, label_475);
    li(var_5, 1000);
    b(label_475);
  label_475:
    b(label_47c);
  label_476:
    bne(var_0, 3, label_479);
    li(var_5, 3);
    b(label_47c);
  label_479:
    bne(var_0, 4, label_47c);
    li(var_5, 4);
    b(label_47c);
  label_47c:
    unitAnimationPlay(shopkeeper, animation_0, 1);
    dialogFree(ref_45a);
    ref_47e = bustupFade(ref_458, rgb(0,0,0), 10);
    bustupWait(ref_47e);
    bustupFree(ref_458);
    ref_481 = shopOpen(19);
    wait(ref_481);
    b(label_484);
  label_484:
}

function HA_SHOP_RESTART_0()
{
    bitGet(var_0, MBIT_HI_TRISHOKUJI);
    bne(var_0, 0, label_4b2);
    choiceSetResult(2);
    op_105(3);
    ref_489 = bustupLoad(bustup_e4);
    bustupWait(ref_489);
    ref_48b = bustupAlloc(ref_489, right, rgb(0,0,0));
    bustupFade(ref_48b, rgb(128,0,0), 30);
    ref_48d = dialogAlloc();
    ref_48e = msgShow(msg_48);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Anything else?
[tab]Say anything♥...
[choice(7)]Heal
Talk to Trish
Never mind
Leave
[end_choice][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_b, 1);
    wait(ref_48e);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    choiceGetResult(var_0);
    bne(var_0, 0, label_496);
    li(var_5, 0);
    b(label_4ac);
  label_496:
    bne(var_0, 1, label_4a6);
    choiceSetResult(2);
    op_105(2);
    ref_499 = msgShow(msg_49);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Yeah, whaddaya want?
[choice(2)]Make small talk
Ask about healing spring
[end_choice][clear]
***************************************/
    wait(ref_499);
    choiceGetResult(var_0);
    bne(var_0, 0, label_49f);
    li(var_5, 1);
    b(label_4a5);
  label_49f:
    bne(var_0, 1, label_4a2);
    li(var_5, 2000);
    b(label_4a5);
  label_4a2:
    bne(var_0, 2, label_4a5);
    li(var_5, 1000);
    b(label_4a5);
  label_4a5:
    b(label_4ac);
  label_4a6:
    bne(var_0, 2, label_4a9);
    li(var_5, 2);
    b(label_4ac);
  label_4a9:
    bne(var_0, 3, label_4ac);
    li(var_5, 3);
    b(label_4ac);
  label_4ac:
    unitAnimationPlay(shopkeeper, animation_0, 1);
    dialogFree(ref_48d);
    ref_4ae = bustupFade(ref_48b, rgb(0,0,0), 10);
    bustupWait(ref_4ae);
    bustupFree(ref_48b);
    b(label_4e1);
  label_4b2:
    bne(var_0, 1, label_4e1);
    choiceSetResult(3);
    op_105(3);
    ref_4b5 = bustupLoad(bustup_e4);
    bustupWait(ref_4b5);
    ref_4b7 = bustupAlloc(ref_4b5, right, rgb(0,0,0));
    bustupFade(ref_4b7, rgb(128,0,0), 30);
    ref_4b9 = dialogAlloc();
    ref_4ba = msgShow(msg_50);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Anything else?
[tab]Say anything♥...
[choice(7)]Heal
Dine in
Talk to Trish
Never mind
Leave
[end_choice][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_b, 1);
    wait(ref_4ba);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    choiceGetResult(var_0);
    bne(var_0, 0, label_4c2);
    li(var_5, 0);
    b(label_4db);
  label_4c2:
    bne(var_0, 1, label_4c5);
    li(var_5, 1);
    b(label_4db);
  label_4c5:
    bne(var_0, 2, label_4d5);
    choiceSetResult(2);
    op_105(2);
    ref_4c8 = msgShow(msg_51);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Yeah, whaddaya want?
[choice(2)]Make small talk
Ask about healing spring
[end_choice][clear]
***************************************/
    wait(ref_4c8);
    choiceGetResult(var_0);
    bne(var_0, 0, label_4ce);
    li(var_5, 2);
    b(label_4d4);
  label_4ce:
    bne(var_0, 1, label_4d1);
    li(var_5, 2000);
    b(label_4d4);
  label_4d1:
    bne(var_0, 2, label_4d4);
    li(var_5, 1000);
    b(label_4d4);
  label_4d4:
    b(label_4db);
  label_4d5:
    bne(var_0, 3, label_4d8);
    li(var_5, 3);
    b(label_4db);
  label_4d8:
    bne(var_0, 4, label_4db);
    li(var_5, 4);
    b(label_4db);
  label_4db:
    unitAnimationPlay(shopkeeper, animation_0, 1);
    dialogFree(ref_4b9);
    ref_4dd = bustupFade(ref_4b7, rgb(0,0,0), 10);
    bustupWait(ref_4dd);
    bustupFree(ref_4b7);
    b(label_4e1);
  label_4e1:
}

function HA_SHOP_TALK_0()
{
    ref_4e2 = bustupLoad(bustup_e4);
    bustupWait(ref_4e2);
    ref_4e4 = bustupAlloc(ref_4e2, right, rgb(0,0,0));
    bustupFade(ref_4e4, rgb(128,0,0), 30);
    ref_4e6 = dialogAlloc();
    ref_4e7 = msgShow(msg_52);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]It’s dangerous outside the door!
[tab]One mistake means a lifetime of pain...
[tab]Don’t be a tightwad, recover![sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_4e7);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_4e6);
    ref_4f6 = bustupFade(ref_4e4, rgb(0,0,0), 10);
    bustupWait(ref_4f6);
    bustupFree(ref_4e4);
}

function HA_SHOP_HEAL_0()
{
    ref_4fa = call(KAIFUKUSURUBEKI);
    wait(ref_4fa);
    bitGet(var_1, LBIT_0000);
    bne(var_1, 0, label_512);
    ref_4fe = bustupLoad(bustup_e4);
    bustupWait(ref_4fe);
    ref_500 = bustupAlloc(ref_4fe, right, rgb(0,0,0));
    bustupFade(ref_500, rgb(128,0,0), 30);
    ref_502 = dialogAlloc();
    ref_503 = msgShow(msg_53);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Then me make it all♪...
[tab]Hey, everyone’s fine!
[tab]You can’t recover like this...!![sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_c, 1);
    unitWait(shopkeeper);
    unitAnimationHold(shopkeeper, animation_9, -1);
    sync();
    wait(ref_503);
    unitAnimationStop(shopkeeper);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_502);
    ref_50d = bustupFade(ref_500, rgb(0,0,0), 10);
    bustupWait(ref_50d);
    bustupFree(ref_500);
    b(label_5c9);
    b(label_55d);
  label_512:
    bne(var_1, 1, label_55d);
    ref_513 = call(GAKUDASI);
    wait(ref_513);
    msgVar_Number(msgvar_5, var_5);
    ref_516 = bustupLoad(bustup_e4);
    bustupWait(ref_516);
    ref_518 = bustupAlloc(ref_516, right, rgb(0,0,0));
    bustupFade(ref_518, rgb(128,0,0), 30);
    ref_51a = dialogAlloc();
    ref_51b = msgShow(msg_54);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]OKAY!! The state that the
[tab]recovery market is in right now...
[tab]The fee is ¥[var(msg_var_5)]!
[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    sync();
    wait(ref_51b);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_51a);
    ref_52a = bustupFade(ref_518, rgb(0,0,0), 10);
    bustupWait(ref_52a);
    bustupFree(ref_518);
    choiceSetResult(1);
    op_105(1);
    ref_52f = bustupLoad(bustup_1);
    bustupWait(ref_52f);
    ref_531 = bustupAlloc(ref_52f, center, rgb(0,0,0));
    bustupFade(ref_531, rgb(128,0,0), 30);
    ref_533 = dialogChoiceAlloc();
    shopCurrencyType(8, -110, 150);
    shopCurrencyDisplay(13, 150, false);
    ref_536 = msgShow(msg_55);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]You’ll heal, right?
[choice(2)]Yes
No
[end_choice][clear]
***************************************/
    wait(ref_536);
    dialogFree(ref_533);
    ref_539 = bustupFade(ref_531, rgb(0,0,0), 10);
    bustupWait(ref_539);
    bustupFree(ref_531);
    choiceGetResult(var_0);
    bne(var_0, 0, label_540);
    b(label_55d);
    b(label_55c);
  label_540:
    bne(var_0, 1, label_55c);
    ref_541 = bustupLoad(bustup_e4);
    bustupWait(ref_541);
    ref_543 = bustupAlloc(ref_541, right, rgb(0,0,0));
    bustupFade(ref_543, rgb(128,0,0), 30);
    ref_545 = dialogAlloc();
    ref_546 = msgShow(msg_56);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Ch... Trying to grin and bear it...
[tab]It’s not my fault if you die...
[tab]Actually, DIE, you cheapskate![sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_1, 1);
    delayClear();
    delayWait(6);
    unitAnimationPlay(shopkeeper, animation_2, 1);
    sync();
    wait(ref_546);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    shopCurrencyDisplay(-110, 150, true);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_545);
    ref_557 = bustupFade(ref_543, rgb(0,0,0), 10);
    bustupWait(ref_557);
    bustupFree(ref_543);
    b(label_5c9);
    b(label_55c);
  label_55c:
    b(label_55d);
  label_55d:
    partyMoneyGet(var_6);
    sub(var_7, var_6, var_5);
    boutrange(var_7, -99999999, -1, label_562);
    b(label_5b8);
    b(label_568);
  label_562:
    li(var_6, 0);
    sub(var_7, var_6, var_5);
    partyMoneyAdd(var_7);
    ref_565 = call(KAIFUKUMESS);
    wait(ref_565);
    b(label_568);
  label_568:
    screenEffectInit();
    screenFade(160, 120, rgb(0,0,0), rgb(0,0,0), add);
    screenFadeInner(rgb(255,255,255), 8, false);
    screenFadeOuter(rgb(255,255,255), 8, false);
    screenFadeWait(inner);
    screenFadeWait(outer);
    sndMusicPlay(sound_3, 127);
    partyMemberCheck(var_3, maya);
    bez(var_3, label_574);
    partyHealthRestore(maya);
    partySPRestore(maya);
    partyStatusClear(maya);
  label_574:
    partyMemberCheck(var_3, ulala);
    bez(var_3, label_579);
    partyHealthRestore(ulala);
    partySPRestore(ulala);
    partyStatusClear(ulala);
  label_579:
    partyMemberCheck(var_3, katsuya);
    bez(var_3, label_57e);
    partyHealthRestore(katsuya);
    partySPRestore(katsuya);
    partyStatusClear(katsuya);
  label_57e:
    partyMemberCheck(var_3, baofu);
    bez(var_3, label_583);
    partyHealthRestore(baofu);
    partySPRestore(baofu);
    partyStatusClear(baofu);
  label_583:
    partyMemberCheck(var_3, nanjo);
    bez(var_3, label_588);
    partyHealthRestore(nanjo);
    partySPRestore(nanjo);
    partyStatusClear(nanjo);
  label_588:
    partyMemberCheck(var_3, elly);
    bez(var_3, label_58d);
    partyHealthRestore(elly);
    partySPRestore(elly);
    partyStatusClear(elly);
  label_58d:
    partyMemberCheck(var_3, tatsuya);
    bez(var_3, label_592);
    partyHealthRestore(tatsuya);
    partySPRestore(tatsuya);
    partyStatusClear(tatsuya);
  label_592:
    screenFade(160, 120, rgb(255,255,255), rgb(255,255,255), add);
    screenFadeInner(rgb(0,0,0), 8, true);
    screenFadeOuter(rgb(0,0,0), 8, true);
    screenEffectUnknown();
    delayClear();
    delayWait(40);
    li(var_0, 0);
    li(var_3, 0);
    bitGet(var_0, bit_c63);
    add(var_3, var_3, var_0);
    bitGet(var_0, bit_c67);
    add(var_3, var_3, var_0);
    bne(var_3, 0, label_5ab);
    ref_59f = bustupLoad(bustup_1);
    bustupWait(ref_59f);
    ref_5a1 = bustupAlloc(ref_59f, center, rgb(0,0,0));
    bustupFade(ref_5a1, rgb(128,0,0), 30);
    ref_5a3 = dialogAlloc();
    ref_5a4 = msgShow(msg_57);
/***************************************
[color(green)]Maya’s party recovered.[color(white)][wait][clear]
***************************************/
    wait(ref_5a4);
    dialogFree(ref_5a3);
    ref_5a7 = bustupFade(ref_5a1, rgb(0,0,0), 10);
    bustupWait(ref_5a7);
    bustupFree(ref_5a1);
    b(label_5b7);
  label_5ab:
    ref_5ab = bustupLoad(bustup_b);
    bustupWait(ref_5ab);
    ref_5ad = bustupAlloc(ref_5ab, center, rgb(0,0,0));
    bustupFade(ref_5ad, rgb(128,0,0), 30);
    ref_5af = dialogAlloc();
    ref_5b0 = msgShow(msg_58);
/***************************************
[color(green)][tatsuya] has recovered.[color(white)][wait][clear]
***************************************/
    wait(ref_5b0);
    dialogFree(ref_5af);
    ref_5b3 = bustupFade(ref_5ad, rgb(0,0,0), 10);
    bustupWait(ref_5b3);
    bustupFree(ref_5ad);
    b(label_5b7);
  label_5b7:
    b(label_5c9);
  label_5b8:
    ref_5b8 = bustupLoad(bustup_e4);
    bustupWait(ref_5b8);
    ref_5ba = bustupAlloc(ref_5b8, right, rgb(0,0,0));
    bustupFade(ref_5ba, rgb(128,0,0), 30);
    ref_5bc = dialogAlloc();
    ref_5bd = msgShow(msg_59);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Alright, I’ll make it all♪...
[tab]Hey, you don’t have enough money!
[tab]Come back when you get some!![sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_c, 1);
    unitWait(shopkeeper);
    unitAnimationPlay(shopkeeper, animation_6, 1);
    sync();
    wait(ref_5bd);
    shopCurrencyDisplay(-110, 150, true);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_5bc);
    ref_5c6 = bustupFade(ref_5ba, rgb(0,0,0), 10);
    bustupWait(ref_5c6);
    bustupFree(ref_5ba);
  label_5c9:
}

function GAKUDASI()
{
    bitGet(var_0, EBIT_E00B8);
    bez(var_0, label_5ce);
    li(var_5, 27000);
    b(label_628);
  label_5ce:
    bitGet(var_0, EBIT_E00AF);
    bez(var_0, label_5d2);
    li(var_5, 26000);
    b(label_628);
  label_5d2:
    bitGet(var_0, EBIT_E009F);
    bez(var_0, label_5d6);
    li(var_5, 25000);
    b(label_628);
  label_5d6:
    bitGet(var_0, EBIT_E008F);
    bez(var_0, label_5da);
    li(var_5, 24000);
    b(label_628);
  label_5da:
    bitGet(var_0, EBIT_E008C);
    bez(var_0, label_5de);
    li(var_5, 23000);
    b(label_628);
  label_5de:
    bitGet(var_0, EBIT_E007F);
    bez(var_0, label_5e2);
    li(var_5, 22000);
    b(label_628);
  label_5e2:
    bitGet(var_0, EBIT_E007B);
    bez(var_0, label_5e6);
    li(var_5, 21000);
    b(label_628);
  label_5e6:
    bitGet(var_0, EBIT_E007A);
    bez(var_0, label_5ea);
    li(var_5, 20000);
    b(label_628);
  label_5ea:
    bitGet(var_0, EBIT_E0077);
    bez(var_0, label_5ee);
    li(var_5, 19000);
    b(label_628);
  label_5ee:
    bitGet(var_0, EBIT_E006F);
    bez(var_0, label_5f2);
    li(var_5, 18000);
    b(label_628);
  label_5f2:
    bitGet(var_0, EBIT_E0046);
    bez(var_0, label_5f6);
    li(var_5, 17000);
    b(label_628);
  label_5f6:
    bitGet(var_0, EBIT_E0045);
    bez(var_0, label_5fa);
    li(var_5, 16000);
    b(label_628);
  label_5fa:
    bitGet(var_0, EBIT_E0044);
    bez(var_0, label_5fe);
    li(var_5, 15000);
    b(label_628);
  label_5fe:
    bitGet(var_0, EBIT_E0043);
    bez(var_0, label_602);
    li(var_5, 14000);
    b(label_628);
  label_602:
    bitGet(var_0, EBIT_E003E);
    bez(var_0, label_606);
    li(var_5, 13000);
    b(label_628);
  label_606:
    bitGet(var_0, EBIT_E0038);
    bez(var_0, label_60a);
    li(var_5, 12000);
    b(label_628);
  label_60a:
    bitGet(var_0, EBIT_E0037);
    bez(var_0, label_60e);
    li(var_5, 11000);
    b(label_628);
  label_60e:
    bitGet(var_0, EBIT_E0033);
    bez(var_0, label_612);
    li(var_5, 10000);
    b(label_628);
  label_612:
    bitGet(var_0, EBIT_E002B);
    bez(var_0, label_616);
    li(var_5, 9000);
    b(label_628);
  label_616:
    bitGet(var_0, EBIT_E002B);
    bez(var_0, label_61a);
    li(var_5, 8000);
    b(label_628);
  label_61a:
    bitGet(var_0, EBIT_E001F);
    bez(var_0, label_61e);
    li(var_5, 7000);
    b(label_628);
  label_61e:
    bitGet(var_0, EBIT_E0018);
    bez(var_0, label_622);
    li(var_5, 6000);
    b(label_628);
  label_622:
    bitGet(var_0, EBIT_E0016);
    bez(var_0, label_626);
    li(var_5, 4000);
    b(label_628);
  label_626:
    li(var_5, 3500);
    b(label_628);
  label_628:
    bitGet(var_0, MBIT_TRI_HENKEN);
    bne(var_0, 0, label_62b);
    b(label_634);
  label_62b:
    bne(var_0, 1, label_634);
    bitGet(var_0, MBIT_TRI_NESAGARI);
    bne(var_0, 0, label_630);
    add(var_5, var_5, var_5);
    b(label_633);
  label_630:
    bne(var_0, 1, label_633);
    div(var_5, var_5, 2);
    b(label_633);
  label_633:
    b(label_634);
  label_634:
    shopInventory(3, shopInventory_3a2);
}

function KAIFUKUMESS()
{
    ref_636 = bustupLoad(bustup_e4);
    bustupWait(ref_636);
    ref_638 = bustupAlloc(ref_636, right, rgb(0,0,0));
    bustupFade(ref_638, rgb(128,0,0), 30);
    ref_63a = dialogAlloc();
    ref_63b = msgShow(msg_60);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]OKAY, here I goooo!
[tab]I’ll make it all better...!
[tab]Pirorororo♪...[sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_6, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(10);
    unitAnimationPlay(shopkeeper, animation_c, 1);
    unitWait(shopkeeper);
    sync();
    wait(ref_63b);
    shopCurrencyDisplay(-110, 150, true);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    dialogFree(ref_63a);
    ref_649 = bustupFade(ref_638, rgb(0,0,0), 10);
    bustupWait(ref_649);
    bustupFree(ref_638);
}

function KAIFUKUSURUBEKI()
{
    partyMemberCheck(var_4, maya);
    bez(var_4, label_65b);
    partyStatusHas(var_0, maya, poison);
    bnz(var_0, label_6b1);
    partyStatusHas(var_0, maya, possesion);
    bnz(var_0, label_6b1);
    partyInfoGet(var_4, maya, maxHealth);
    partyInfoGet(var_5, maya, health);
    beq(var_4, var_5, label_657);
    b(label_6b1);
  label_657:
    partyInfoGet(var_4, maya, maxSP);
    partyInfoGet(var_5, maya, sp);
    beq(var_4, var_5, label_65b);
    b(label_6b1);
  label_65b:
    partyMemberCheck(var_4, ulala);
    bez(var_4, label_669);
    partyStatusHas(var_0, ulala, poison);
    bnz(var_0, label_6b1);
    partyStatusHas(var_0, ulala, possesion);
    bnz(var_0, label_6b1);
    partyInfoGet(var_4, ulala, maxHealth);
    partyInfoGet(var_5, ulala, health);
    beq(var_4, var_5, label_665);
    b(label_6b1);
  label_665:
    partyInfoGet(var_4, ulala, maxSP);
    partyInfoGet(var_5, ulala, sp);
    beq(var_4, var_5, label_669);
    b(label_6b1);
  label_669:
    partyMemberCheck(var_4, katsuya);
    bez(var_4, label_677);
    partyStatusHas(var_0, katsuya, poison);
    bnz(var_0, label_6b1);
    partyStatusHas(var_0, katsuya, possesion);
    bnz(var_0, label_6b1);
    partyInfoGet(var_4, katsuya, maxHealth);
    partyInfoGet(var_5, katsuya, health);
    beq(var_4, var_5, label_673);
    b(label_6b1);
  label_673:
    partyInfoGet(var_4, katsuya, maxSP);
    partyInfoGet(var_5, katsuya, sp);
    beq(var_4, var_5, label_677);
    b(label_6b1);
  label_677:
    partyMemberCheck(var_4, baofu);
    bez(var_4, label_685);
    partyStatusHas(var_0, baofu, poison);
    bnz(var_0, label_6b1);
    partyStatusHas(var_0, baofu, possesion);
    bnz(var_0, label_6b1);
    partyInfoGet(var_4, baofu, maxHealth);
    partyInfoGet(var_5, baofu, health);
    beq(var_4, var_5, label_681);
    b(label_6b1);
  label_681:
    partyInfoGet(var_4, baofu, maxSP);
    partyInfoGet(var_5, baofu, sp);
    beq(var_4, var_5, label_685);
    b(label_6b1);
  label_685:
    partyMemberCheck(var_4, nanjo);
    bez(var_4, label_693);
    partyStatusHas(var_0, nanjo, poison);
    bnz(var_0, label_6b1);
    partyStatusHas(var_0, nanjo, possesion);
    bnz(var_0, label_6b1);
    partyInfoGet(var_4, nanjo, maxHealth);
    partyInfoGet(var_5, nanjo, health);
    beq(var_4, var_5, label_68f);
    b(label_6b1);
  label_68f:
    partyInfoGet(var_4, nanjo, maxSP);
    partyInfoGet(var_5, nanjo, sp);
    beq(var_4, var_5, label_693);
    b(label_6b1);
  label_693:
    partyMemberCheck(var_4, elly);
    bez(var_4, label_6a1);
    partyStatusHas(var_0, elly, poison);
    bnz(var_0, label_6b1);
    partyStatusHas(var_0, elly, possesion);
    bnz(var_0, label_6b1);
    partyInfoGet(var_4, elly, maxHealth);
    partyInfoGet(var_5, elly, health);
    beq(var_4, var_5, label_69d);
    b(label_6b1);
  label_69d:
    partyInfoGet(var_4, elly, maxSP);
    partyInfoGet(var_5, elly, sp);
    beq(var_4, var_5, label_6a1);
    b(label_6b1);
  label_6a1:
    partyMemberCheck(var_4, tatsuya);
    bez(var_4, label_6af);
    partyStatusHas(var_0, tatsuya, poison);
    bnz(var_0, label_6b1);
    partyStatusHas(var_0, tatsuya, possesion);
    bnz(var_0, label_6b1);
    partyInfoGet(var_4, tatsuya, maxHealth);
    partyInfoGet(var_5, tatsuya, health);
    beq(var_4, var_5, label_6ab);
    b(label_6b1);
  label_6ab:
    partyInfoGet(var_4, tatsuya, maxSP);
    partyInfoGet(var_5, tatsuya, sp);
    beq(var_4, var_5, label_6af);
    b(label_6b1);
  label_6af:
    bitClear(LBIT_0000);
    b(label_6b3);
  label_6b1:
    bitSet(LBIT_0000);
    b(label_6b3);
  label_6b3:
}

function HA_SHOP_END_0()
{
    ref_6b4 = bustupLoad(bustup_e4);
    bustupWait(ref_6b4);
    ref_6b6 = bustupAlloc(ref_6b4, right, rgb(0,0,0));
    bustupFade(ref_6b6, rgb(128,0,0), 30);
    ref_6b8 = dialogAlloc();
    ref_6b9 = msgShow(msg_61);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Come again!
[tab]I’ll be waiting...
[tab]Bye-bye![sync][wait][clear]
***************************************/
    unitAnimationPlay(shopkeeper, animation_7, 1);
    delayClear();
    delayWait(30);
    unitAnimationPlay(shopkeeper, animation_0, 1);
    delayClear();
    delayWait(20);
    unitAnimationPlay(shopkeeper, animation_7, 1);
    sync();
    wait(ref_6b9);
    unitAnimationPlay(shopkeeper, animation_b, 1);
    shopOverlayInit();
    dialogFree(ref_6b8);
    ref_6c6 = bustupFade(ref_6b6, rgb(0,0,0), 10);
    bustupWait(ref_6c6);
    bustupFree(ref_6b6);
    bitGet(var_0, MBIT_EXITBIT);
    bne(var_0, 0, label_6ce);
    unitRestoreFacing(shopkeeper);
    controlEnable();
    b(label_6d1);
  label_6ce:
    bne(var_0, 1, label_6d1);
    call(EXITBOX);
    b(label_6d1);
  label_6d1:
}

function HA_SHOP_EXPLAIN_0()
{
    choiceSetResult(7);
    op_105(7);
    ref_6d4 = dialogChoiceAlloc();
    ref_6d5 = msgShow(msg_62);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]What do you want to know?
[choice(3)]Ask about healing
[if_all(MBIT_HI_TRISHOKUJI)]Ask about dining in
Nothing
[end_choice][clear]
***************************************/
    wait(ref_6d5);
    dialogFree(ref_6d4);
    choiceGetResult(var_0);
    bne(var_0, 0, label_6df);
    ref_6da = dialogAlloc();
    ref_6db = msgShow(msg_63);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]Okay! Healing, right?
[tab]Choose "Heal" here and I’ll restore your HP and
[tab]SP, plus cure any status ailments like poison.
[wait][clear][color(yellow)]Trish[color(white)]
[tab]My fees depend on the current market value for
[tab]healing, but I do cure everyone, so you might
[tab]save a little in the long run.
[wait][clear]
***************************************/
    wait(ref_6db);
    dialogFree(ref_6da);
    b(label_6e7);
  label_6df:
    bne(var_0, 1, label_6e5);
    ref_6e0 = dialogAlloc();
    ref_6e1 = msgShow(msg_64);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]OK! I’ll explain how to dine in.
[tab]When you select "Dine in" here 
[tab]I will treat you to delicious ice cream!
[wait][clear][color(yellow)]Trish[color(white)]
[tab]Of course there is a charge ♪
[tab]When you eat the ice cream...
[tab]You temporarily power up!
[wait][clear][color(yellow)]Trish[color(white)]
[tab]Awesome, right? You just want to eat 
[tab]ice cream all the time, right? By the way, 
[tab]the effect depends on the ice cream, 
[wait][clear][color(yellow)]Trish[color(white)]
[tab]so try all the types. But you can’t 
[tab]eat another one until the effect of
[tab]the last one has worn off. 
[wait][clear]
***************************************/
    wait(ref_6e1);
    dialogFree(ref_6e0);
    b(label_6e7);
  label_6e5:
    bne(var_0, 2, label_6e7);
    b(label_6e7);
  label_6e7:
}

function EXITBOX()
{
    controlDisable();
    bitClear(MBIT_EXITBIT);
    shopInventory(3, shopInventory_2a9);
    bne(var_3, 0, label_6ed);
    b(label_6f0);
  label_6ed:
    bne(var_3, 1, label_6f0);
    b(label_731);
    b(label_6f0);
  label_6f0:
    bitGet(var_1, bit_c6b);
    bne(var_1, 0, label_6f3);
    b(label_6f6);
  label_6f3:
    bne(var_1, 1, label_6f6);
    b(label_72f);
    b(label_6f6);
  label_6f6:
    bitGet(var_0, MBIT_TORI2TORI);
    bne(var_0, 0, label_72a);
    unknownVar1(var_0);
    bne(var_0, 514, label_6fc);
    dngLoad2(sanitarium-2);
    b(label_728);
  label_6fc:
    bne(var_0, 780, label_6ff);
    dngLoad2(aerospace_museum-12);
    b(label_728);
  label_6ff:
    bne(var_0, 1029, label_702);
    dngLoad2(gold-5);
    b(label_728);
  label_702:
    bne(var_0, 1541, label_705);
    dngLoad2(aoba_park-5);
    b(label_728);
  label_705:
    bne(var_0, 2050, label_708);
    dngLoad2(science_lab1-2);
    b(label_728);
  label_708:
    bne(var_0, 2570, label_70b);
    dngLoad2(sumaru_tv2-10);
    b(label_728);
  label_70b:
    bne(var_0, 2826, label_70e);
    dngLoad2(smile_hirasaka1-10);
    b(label_728);
  label_70e:
    bne(var_0, 3073, label_711);
    dngLoad2(abandoned_factory-1);
    b(label_728);
  label_711:
    bne(var_0, 3338, label_714);
    dngLoad2(nichirinmaru1-10);
    b(label_728);
  label_714:
    bne(var_0, 3618, label_717);
    dngLoad2(undersea_ruin-34);
    b(label_728);
  label_717:
    bne(var_0, 3855, label_71a);
    dngLoad2(mt_iwato-15);
    b(label_728);
  label_71a:
    bne(var_0, 4871, label_71d);
    dngLoad2(monad1-7);
    b(label_728);
  label_71d:
    bne(var_0, 5889, label_720);
    dngLoad2(mu_continent-1);
    b(label_728);
  label_720:
    bne(var_0, 12290, label_723);
    dngLoad2(science_lab2-2);
    b(label_728);
  label_723:
    ref_723 = dialogChoiceAlloc();
    ref_724 = msgShow(msg_65);
/***************************************
Error: I don’t know where I came from ...

***************************************/
    wait(ref_724);
    dialogFree(ref_723);
    b(label_728);
  label_728:
    b(label_732);
    b(label_72e);
  label_72a:
    bne(var_0, 1, label_72e);
    eventLoad(event_e1);
    b(label_732);
    b(label_72e);
  label_72e:
    b(label_732);
  label_72f:
    mapLoad(last, 255, 255);
    b(label_732);
  label_731:
    mapLoad(rengedai, 0, 0);
  label_732:
}

function warp1()
{
    call(EXITBOX);
}

function DECIDE_EAT()
{
    choiceSetResult(1);
    op_105(1);
    msgVar_Number(msgvar_0, var_6);
    unitFacePlayer(shopkeeper);
    ref_739 = bustupLoad(bustup_e4);
    bustupWait(ref_739);
    ref_73b = bustupAlloc(ref_739, left, rgb(0,0,0));
    bustupFade(ref_73b, rgb(128,0,0), 30);
    ref_73d = dialogAlloc();
    choiceSetResult(1);
    op_105(1);
    ref_740 = msgShow(msg_66);
/***************************************
[color(yellow)]Trish[color(white)]
[tab]That ice cream costs ¥[var(msg_var_0)]
[tab]Will you dine in?
[choice(2)]Yes
No
[end_choice][clear]
***************************************/
    wait(ref_740);
    choiceGetResult(var_7);
    bne(var_7, 0, label_746);
    li(var_7, 1);
    b(label_749);
  label_746:
    bne(var_7, 1, label_749);
    li(var_7, 0);
    b(label_749);
  label_749:
    wait(ref_740);
    dialogFree(ref_73d);
    ref_74b = bustupFade(ref_73b, rgb(0,0,0), 10);
    bustupWait(ref_74b);
    bustupFree(ref_73b);
    li(var_5, 20);
}
